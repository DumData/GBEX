# GBEX - Goodbye Excel: A MetaDataStore and more

### What is this?
This is a system for replacing excel based registration sheets with a web-based database backed solution.  
It uses Django as the backend and a custom REACT based frontend.   
You setup database models and then the system should be able to understand that and create GUI and API access to them.

### Quickstart
docker-compose up -d  
After docker finishes you should create a superuser  
docker exec -ti -u worker gbex_gbex_1 python manage.py createsuperuser  
  
Then you should be able to visit:
   1) Main page: http://localhost
   2) DRF API: http://localhost/api
   3) OpenAPI swagger: http://localhost/swagger
   4) OpenAPI redoc: http://localhost/redoc

### How it works:
Nearly all changes of a custom GBEX instance should be made to "GBEX_app/models".  
There are a few base models that need to be used:
* Profile in "GBEX_app/models/models.py"
  * This model is used to attach a required "table_settings" json object that is used by the frontend to save personalized user settings
* GBEXModelBase in "GBEX_app/models/models.py"
  * This is an abstract model that all other models should inherit
  * It has the followed fields that are required by all other frontend displayed models:
    * name: This is intended as a non-editable unique human understandable identifier
    * responsible: A link to the USER that created this object
	* created: automatic field with creation date
	* edited: automatic field with edit date
	* archived: Archived objects are not send to the frontend (still accessible in admin interface)
	* order: This object is used to determine which fields should be displayed and in which order
	* symbol: By default, "name" is generated by using "symbol" and adding a number. E.g. Symbol is "PL", then the first object will be "PL1", second object will be "PL2"
	* col_display_func_dict: Most fields have a great default display function, but sometimes you may want to customize it. Almost always the case for many2many objects
	* widgets: By default django default widgets are used, but you may want to used another, e.g. for autocompletes for foreignkeys using django-autocomplete-light
	* model_kind: Currently this can be:
	   * GBEX_Page: This indicates that this is a frontend item
	   * GBEX_Option: This is for a user controlled dictionary. A GBEX_Page model linked field (foreignkey/manytomany) where the user can add items.
	   * GBEX_Batch: If a GBEX_Page model has batches enabled then this is that model =) 
	* col_html_string: By default the react based frontend will just show a string, but columns in this list will be displayed as HTML e.g. to create hyperlinks
	* col_read_only: By default the GUI will attempt to get an edit widget from the backend, but not for columns in this list. Effectively this means that the frontend can't edit these fields.
* Menus are generated by "links" in GBEX_app/template_tags/tags.py 
  * It uses the "menu_label" attribute of models with "model_kind" == "GBEX_Page"
  


### Changelog
* Archive feature: Implemented so it simply hides archived items on list pages. They can still be linked and found in link searches.


### Todos
Move models col_display_func_dict into helpers.field_to_string for many2many fields
Make a custom thing to check on delete whether object is used in Many-to-many relation and if so, prevent deletion


### Batch model todos
* Batches
  * (check) Make batch abstract
  * (checkish) Make 2-3 test instances of batch
  * (check) When sending data to frontend, add info on whether or not this has batches and maybe also batch aggregate data
  * (check) Make a "custom_column_string" and "custom_column_action" list on the list.html template.
  * (check) Make frontend know that the batch column should be a link to the batch url
  * (check) Update GUI to display batchcolumn as links
  * Make url and view for batches
    * Tactic 1:
        * Copy the entire urls generator thingy
            * Make the urls include Parent Model and PK
            * Make the forms exclude Parent (prefill it from url)
        * Maybe make a menu item to batch models as completely regular views